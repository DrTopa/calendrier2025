<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéÆ Game 11 ‚Äì GOTY 2025 + Euromillions üéÆ</title>

  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      background-color: #ffebcd;
      background-image: url('https://www.transparenttextures.com/patterns/snow.png');
      margin: 0;
      padding: 20px;
    }
    h1 {
      font-size: 2.3em;
      margin-bottom: 10px;
      color: #b71c1c;
      font-family: 'Comic Sans MS', cursive;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.3);
      text-align: center;
    }
    #userStatus { position:absolute; top:10px; right:10px; font-size:1.1em; color:#a23636;}
    .panel {
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 8px 12px rgba(0,0,0,0.2);
      margin-bottom: 20px;
      text-align: center;
      max-width: 720px;
      width: 100%;
    }
    select, input {
      padding: 10px;
      font-size: 1.05em;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
      width: 100%;
      box-sizing: border-box;
    }
    .row { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    #submit-btn {
      padding: 12px 24px;
      font-size: 1.15em;
      cursor: pointer;
      background-color: #388e3c;
      color: white;
      border: none;
      border-radius: 6px;
      margin-top: 10px;
    }
    #submit-btn:hover { background-color:#2e7d32; }
    #your-answer {
      margin-top: 15px;
      font-weight: bold;
      font-size: 1.1em;
      color: #2e7d32;
    }
    #answersList {
      display: none;
      margin-top: 25px;
      padding: 15px;
      border-radius: 10px;
      background: rgba(255,255,255,0.95);
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      max-width: 720px;
      width: 100%;
    }
    #answersList li {
      background: rgba(250,250,250,0.9);
      margin: 8px 0;
      padding: 10px;
      border-left: 5px solid #b71c1c;
      border-radius: 6px;
      list-style:none;
    }
    .small { font-size:0.9em; color:#666; }
  </style>
</head>

<body>

<h1>üéÆ Pronostics ‚Äì GOTY 2025 + Euromillions üéÆ</h1>
<div id="userStatus"></div>

<!-- ===== PANEL GOTY ===== -->
<div class="panel" id="goty-panel">
  <h2>üèÜ Paris GOTY 2025</h2>

  <select id="goty">
    <option value="">GOTY</option>
    <option>Clair Obscur: Expedition 33</option>
    <option>Death Stranding 2: On the Beach</option>
    <option>Hades II</option>
    <option>Kingdom Come: Deliverance II</option>
    <option>Hollow Knight : Silksong</option>
  </select>

  <select id="narrative"><option value="">Best Narrative</option><option>Clair Obscur: Expedition 33</option><option>Death Stranding 2: On the Beach</option><option>Ghost of Y≈çtei</option><option>Kingdom Come: Deliverance II</option><option>Silent Hill f</option></select>
  <select id="audio"><option value="">Best Audio</option><option>Battlefield 6</option><option>Clair Obscur: Expedition 33</option><option>Death Stranding 2</option><option>Ghost of Y≈çtei</option><option>Silent Hill f</option></select>
  <select id="indie"><option value="">Best Indie</option><option>Absolum</option><option>Ball x Pit</option><option>Blue Prince</option><option>Clair Obscur: Expedition 33</option><option>Hades II</option><option>Hollow Knight: Silksong</option></select>
  <select id="mobile"><option value="">Best Mobile</option><option>Destiny: Rising</option><option>Persona 5: The Phantom X</option><option>Sonic Rumble</option><option>Umamusume: Pretty Derby</option><option>Wuthering Waves</option></select>
  <select id="action"><option value="">Best Action/Adventure</option><option>Death Stranding 2</option><option>Ghost of Y≈çtei</option><option>Indiana Jones</option><option>Hollow Knight : Silksong</option><option>Split Fiction</option></select>
  <select id="family"><option value="">Best Family</option><option>Donkey Kong Bananza</option><option>LEGO Party!</option><option>LEGO Voyagers</option><option>Mario Kart World</option><option>Sonic Racing</option></select>
  <select id="sports"><option value="">Best Sports</option><option>EA Sports 26</option><option>F1 25</option><option>Mario Kart World</option><option>Remarch</option><option>Sonic Racing</option></select>
  <select id="multiplayer"><option value="">Best Multiplayer</option><option>ARC Raiders</option><option>Battlefield 6</option><option>Elden Ring Nightreign</option><option>Peak</option><option>Split Fiction</option></select>
</div>

<!-- ===== PANEL EUROMILLIONS ===== -->
<div class="panel">
  <h2>üí´ Euromillions</h2>

  <div class="row">
    <input id="e1" type="number" min="1" max="50" placeholder="Num√©ro 1 (1-50)">
    <input id="e2" type="number" min="1" max="50" placeholder="Num√©ro 2 (1-50)">
  </div>
  <div class="row">
    <input id="e3" type="number" min="1" max="50" placeholder="Num√©ro 3 (1-50)">
    <input id="e4" type="number" min="1" max="50" placeholder="Num√©ro 4 (1-50)">
  </div>
  <input id="e5" type="number" min="1" max="50" placeholder="Num√©ro 5 (1-50)">
  <div class="row">
    <input id="s1" type="number" min="1" max="12" placeholder="√âtoile 1 (1-12)">
    <input id="s2" type="number" min="1" max="12" placeholder="√âtoile 2 (1-12)">
  </div>
</div>

<button id="submit-btn">Soumettre mes paris</button>
<div id="your-answer"></div>

<div id="answersList">
  <h3>üìä Paris des autres joueurs :</h3>
  <ul id="answers"></ul>
</div>

<!-- ===== FIREBASE ===== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDDlMXjm5ibq9FiPOjrBD1HFAIlYRnCzqA",
  authDomain: "calendrier2025-3185f.firebaseapp.com",
  projectId: "calendrier2025-3185f",
  storageBucket: "calendrier2025-3185f.firebasestorage.app",
  messagingSenderId: "846792576145",
  appId: "1:846792576145:web:59028ccef4ffd5c8010330"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentUser = null;

onAuthStateChanged(auth, async (user) => {
  if (!user) return window.location.href = "login.html";
  currentUser = user;
  document.getElementById("userStatus").innerText = "Connect√© : " + user.email;
  loadOthers();
});

function isValidEuro(nums, stars) {
  return new Set(nums).size===5 && new Set(stars).size===2 &&
    nums.every(n=>n>=1 && n<=50) && stars.every(s=>s>=1 && s<=12);
}

document.getElementById("submit-btn").addEventListener("click", async () => {
  const gotyFields = ["goty","narrative","audio","indie","mobile","action","family","sports","multiplayer"];
  const data = {};

  for (const f of gotyFields) {
    const val = document.getElementById(f).value;
    if (!val) return alert("Remplis tous les champs GOTY");
    data[f] = val;
  }

  const nums = [+e1.value,+e2.value,+e3.value,+e4.value,+e5.value];
  const stars = [+s1.value,+s2.value];
  if(!isValidEuro(nums, stars)) return alert("Num√©ros Euromillions invalides");

  data.euroNums = nums;
  data.euroStars = stars;
  data.email = currentUser.email;
  data.timestamp = new Date().toISOString();

  const ref = doc(db,"Predictions","Jour 11");
  const snap = await getDoc(ref);

  if (snap.exists()) {
    await updateDoc(ref, { [currentUser.uid]: data });
  } else {
    await setDoc(ref, { [currentUser.uid]: data });
  }

  document.getElementById("your-answer").innerHTML = "‚úÖ Paris enregistr√©s !";
  loadOthers();
});

async function loadOthers() {
  const ref = doc(db,"Predictions","Jour 11");
  const snap = await getDoc(ref);
  if(!snap.exists()) return;

  const ul = document.getElementById("answers");
  ul.innerHTML = "";

  Object.entries(snap.data()).forEach(([uid,d])=>{
    if(uid===currentUser.uid) return;
    const li = document.createElement("li");
    li.innerHTML = `<b>${d.email}</b><br>üéÆ GOTY: ${d.goty}<br>üí´ ${d.euroNums.join(", ")} ‚≠ê ${d.euroStars.join(", ")}`;
    ul.appendChild(li);
  });
  document.getElementById("answersList").style.display="block";
}
</script>

</body>
</html>
