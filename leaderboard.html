<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Collection</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background-color: #ffebcd;
      background-image: url('https://www.transparenttextures.com/patterns/snow.png');
      margin: 0;
      padding: 20px;
      color: #333;
    }

    h1 {
      text-align: center;
      font-size: 2.5em;
      margin-bottom: 30px;
      color: #d32f2f;
      font-family: 'Comic Sans MS', cursive;
      text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
    }

    .user-collection {
      margin-bottom: 50px;
      padding: 20px;
      background: rgba(255,255,255,0.9);
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .user-header {
      font-size: 1.5em;
      margin-bottom: 15px;
      color: #2e7d32;
    }

    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
    }

    .card-slot {
      width: 160px;
      height: 160px;
      display: flex;
      justify-content: center;
      align-items: center;
      border: 2px dashed #ccc;
      border-radius: 10px;
      background: #fafafa;
      font-size: 1.2em;
      font-weight: bold;
      color: #777;
    }

    .card-slot img {
      max-width: 100%;
      max-height: 100%;
      border-radius: 10px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    }

    /* Classement */
    #leaderboard {
      margin-top: 40px;
      padding: 20px;
      background: rgba(255,255,255,0.95);
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    #leaderboard h2 {
      text-align: center;
      color: #b71c1c;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      text-align: center;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 12px;
      font-size: 1.2em;
    }

    th {
      background-color: #d32f2f;
      color: white;
    }

    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
  <h1>üéÑ Collections des joueurs üéÑ</h1>
  <div id="collections"></div>

  <div id="leaderboard">
    <h2>üèÜ Classement des joueurs üèÜ</h2>
    <table>
      <thead>
        <tr>
          <th>Joueur</th>
          <th>Nombre de cartes obtenues</th>
        </tr>
      </thead>
      <tbody id="leaderboard-body"></tbody>
    </table>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyDDlMXjm5ibq9FiPOjrBD1HFAIlYRnCzqA",
      authDomain: "calendrier2025-3185f.firebaseapp.com",
      projectId: "calendrier2025-3185f",
      storageBucket: "calendrier2025-3185f.firebasestorage.app",
      messagingSenderId: "846792576145",
      appId: "1:846792576145:web:59028ccef4ffd5c8010330",
      measurementId: "G-L62L4JSYMF"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // dictionnaire Picture -> URL
    const pictureLinks = {
      1: "https://i.imgur.com/ewqwwd3.png",
      2: "https://i.imgur.com/MiUjcra.png",
      3: "https://i.imgur.com/apINuyT.png",
      4: "https://i.imgur.com/HGmmFRo.png",
      5: "https://i.imgur.com/ihhHq2q.png",
      6: "https://i.imgur.com/kurR7Fg.png",
      7: "https://i.imgur.com/CruwG9r.png",
      8: "https://i.imgur.com/SOVLwmr.png",
      9: "https://i.imgur.com/i0hCSeW.png",
      10: "https://i.imgur.com/A8xouVf.png",
      11: "https://i.imgur.com/BDCQ2kM.png",
      12: "https://i.imgur.com/Ppdjtu6.png",
      13: "https://i.imgur.com/w47g1xe.png",
      14: "https://i.imgur.com/Vimn4hL.png",
      15: "https://i.imgur.com/ZgLeo3r.png",
      16: "https://i.imgur.com/4HwEdtu.png",
      17: "https://i.imgur.com/QrjAXaO.png",
      18: "https://i.imgur.com/3UQctnY.png",
      19: "https://i.imgur.com/GgxbxSR.png",
      20: "https://i.imgur.com/6qc7FPn.png",
      21: "https://i.imgur.com/hylK7Oe.png",
      22: "https://i.imgur.com/yJFcl3Z.png",
      23: "https://i.imgur.com/ZBur6N5.png",
      24: "https://i.imgur.com/mI6ix2S.png",
      25: "https://i.imgur.com/wR2CIoG.png",
      26: "https://i.imgur.com/55Kw0Nl.png",
      27: "https://i.imgur.com/wxbAOzj.png",
      28: "https://i.imgur.com/behZzHj.png",
      29: "https://i.imgur.com/KgvWBEL.png",
      30: "https://i.imgur.com/U8CjA75.png",
      31: "https://i.imgur.com/1L1qN3E.png",
      32: "https://i.imgur.com/8UzGnPn.png",
      33: "https://i.imgur.com/XkSp2h8.png",
      34: "https://i.imgur.com/GvJpwqW.png",
      35: "https://i.imgur.com/zMdItr2.png",
      36: "https://i.imgur.com/HKOS9R3.png",
      37: "https://i.imgur.com/UXBVHeZ.png",
      38: "https://i.imgur.com/gtAzNLQ.png",
      39: "https://i.imgur.com/lcYg9w1.png",
      40: "https://i.imgur.com/qqnSfZF.png",
      41: "https://i.imgur.com/FvuN276.png",
      42: "https://i.imgur.com/Ye5uyiE.png",
      43: "https://i.imgur.com/g50GLoG.png",
      44: "https://i.imgur.com/uIfvKVG.png",
      45: "https://i.imgur.com/9zLEKsk.png",
      46: "https://i.imgur.com/V0XuA2I.png",
      47: "https://i.imgur.com/G7tVea1.png",
      48: "https://i.imgur.com/zhMkGHm.png",
      49: "https://i.imgur.com/QcHQzy8.png",
      50: "https://i.imgur.com/g88RqCc.png",
      51: "https://i.imgur.com/46cx2gP.png",
      52: "https://i.imgur.com/h3ZbyhC.png",
      53: "https://i.imgur.com/ulcpx9p.png",
      54: "https://i.imgur.com/0dXsNyO.png",
      55: "https://i.imgur.com/3AJToac.png",
      56: "https://i.imgur.com/mL5WQyW.png",
      57: "https://i.imgur.com/KUOYPn7.png",
      58: "https://i.imgur.com/bIUpa5z.png",
      59: "https://i.imgur.com/y7dqXOr.png",
      60: "https://i.imgur.com/qYXH9ic.png",
      61: "https://i.imgur.com/mcs0iV6.png",
      62: "https://i.imgur.com/xDuaNuC.png",
      63: "https://i.imgur.com/tz1oaE6.png",
      64: "https://i.imgur.com/nPuwu22.png",
      65: "https://i.imgur.com/ezMbxnf.png",
      66: "https://i.imgur.com/jfrVisV.png",
      67: "https://i.imgur.com/EsOGQlC.png",
      68: "https://i.imgur.com/l8jwwRa.png",
      69: "https://i.imgur.com/WrxnlKe.png",
      70: "https://i.imgur.com/TBHpA6n.png",
      71: "https://i.imgur.com/TwRXNCp.png",
      72: "https://i.imgur.com/QxbGzRC.png",
      73: "https://i.imgur.com/DCqpBot.png",
      74: "https://i.imgur.com/VNV9grK.png",
      75: "https://i.imgur.com/tlMwUmg.png",
      76: "https://i.imgur.com/SmysCbX.png",
      77: "https://i.imgur.com/Wvt21zL.png",
      78: "https://i.imgur.com/12s1WaQ.png",
      79: "https://i.imgur.com/EMo7O1h.png",
      80: "https://i.imgur.com/FCpnXVM.png",
      81: "https://i.imgur.com/3unY1WO.png",
      82: "https://i.imgur.com/eCfS1rL.png",
      83: "https://i.imgur.com/Zsfc0OW.png",
      84: "https://i.imgur.com/XUUsW7t.png",
      85: "https://i.imgur.com/Z0KsIJS.png",
      86: "https://i.imgur.com/vAvKqW5.png",
      87: "https://i.imgur.com/0oBYzEs.png",
      88: "https://i.imgur.com/7oN3Ivg.png",
      89: "https://i.imgur.com/HcQgtUu.png",
      90: "https://i.imgur.com/Yz1yYqt.png",
      91: "https://i.imgur.com/bh3wUgz.png",
      92: "https://i.imgur.com/8yvWgVw.png"
    };

    async function loadCollections() {
      const usersRef = collection(db, "users");
      const snapshot = await getDocs(usersRef);
      const container = document.getElementById("collections");
      const leaderboardBody = document.getElementById("leaderboard-body");
      const leaderboard = [];

      snapshot.forEach(docSnap => {
        const data = docSnap.data();
        const div = document.createElement("div");
        div.classList.add("user-collection");

        let count = 0;

        // en-t√™te
        div.innerHTML = `<div class="user-header">${data.email} ‚Äî Jetons : ${data.jetons ?? 0}</div>`;

        const grid = document.createElement("div");
        grid.classList.add("cards-grid");

        for (let i = 1; i <= 92; i++) {
          const slot = document.createElement("div");
          slot.classList.add("card-slot");

          if (data[`Picture${i}`]) {
            const img = document.createElement("img");
            img.src = pictureLinks[i];
            img.alt = `Picture ${i}`;
            slot.appendChild(img);
            count++;
          } else {
            slot.textContent = i;
          }

          grid.appendChild(slot);
        }

        div.appendChild(grid);
        container.appendChild(div);

        leaderboard.push({ email: data.email, count });
      });

      // trier par nombre de cartes d√©croissant
      leaderboard.sort((a, b) => b.count - a.count);

      leaderboard.forEach(player => {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${player.email}</td><td>${player.count}</td>`;
        leaderboardBody.appendChild(row);
      });
    }

    loadCollections();
  </script>
</body>
</html>
